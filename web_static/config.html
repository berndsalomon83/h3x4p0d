<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hexapod Configuration</title>
  <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
  <link rel="stylesheet" href="/static/config.css">
</head>
<body>
  <!-- ===== HEADER ===== -->
  <header class="app-header">
    <div class="app-logo">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"/>
        <path d="M12 2v4M12 18v4M2 12h4M18 12h4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
      </svg>
      Hexapod Config
    </div>

    <nav class="header-nav" style="display: flex; gap: 16px; margin-left: 24px;">
      <a href="http://localhost:8000" style="color: var(--text-muted); text-decoration: none; font-size: 13px;">← Controller</a>
    </nav>

    <div class="header-controls">
      <div class="header-group">
        <span class="header-label">Profile</span>
        <select class="header-select" id="profileSelect">
          <option value="default">Default</option>
          <option value="outdoor_rough">Outdoor Rough</option>
          <option value="indoor_demo">Indoor Demo</option>
          <option value="calibration">Calibration</option>
        </select>
      </div>

      <div class="header-group">
        <span class="header-label">Target</span>
        <select class="header-select" id="targetSelect">
          <option value="simulation">Simulation</option>
          <option value="real">Real Robot</option>
          <option value="both">Both</option>
        </select>
      </div>
    </div>

    <div class="header-status">
      <div class="status-indicator">
        <span class="status-dot connected" id="connectionDot"></span>
        <span id="connectionText">Connected</span>
      </div>
      <div class="status-indicator">
        <span class="status-dot warning"></span>
        <span>Battery: 11.4V</span>
      </div>
      <button class="estop-btn" id="estopBtn">E-STOP</button>
    </div>
  </header>

  <!-- ===== LEFT NAVIGATION ===== -->
  <nav class="nav-sidebar">
    <div class="nav-section">
      <div class="nav-section-title">Configuration</div>
      <div class="nav-item active" data-section="overview">
        <span class="nav-item-icon">&#x1F3E0;</span>
        Overview & Profiles
      </div>
      <div class="nav-item" data-section="geometry">
        <span class="nav-item-icon">&#x1F4D0;</span>
        Geometry & Frames
      </div>
      <div class="nav-item" data-section="servos">
        <span class="nav-item-icon">&#x2699;</span>
        Servos & Calibration
      </div>
      <div class="nav-item" data-section="posture">
        <span class="nav-item-icon">&#x1F9CD;</span>
        Body Posture & Poses
      </div>
      <div class="nav-item" data-section="gaits">
        <span class="nav-item-icon">&#x1F6B6;</span>
        Gaits & Motion
      </div>
    </div>

    <div class="nav-section">
      <div class="nav-section-title">Hardware</div>
      <div class="nav-item" data-section="sensors">
        <span class="nav-item-icon">&#x1F4F7;</span>
        Sensors & Cameras
      </div>
      <div class="nav-item" data-section="control">
        <span class="nav-item-icon">&#x1F3AE;</span>
        Control & Input
      </div>
      <div class="nav-item" data-section="safety">
        <span class="nav-item-icon">&#x1F6A8;</span>
        Safety & Limits
        <span class="nav-item-badge">!</span>
      </div>
    </div>

    <div class="nav-section">
      <div class="nav-section-title">System</div>
      <div class="nav-item" data-section="system">
        <span class="nav-item-icon">&#x1F5A5;</span>
        System & Network
      </div>
      <div class="nav-item" data-section="logging">
        <span class="nav-item-icon">&#x1F4CA;</span>
        Logging & Diagnostics
      </div>
    </div>
  </nav>

  <!-- ===== MAIN CONTENT ===== -->
  <main class="main-content">
    <!-- ===== SECTION: Overview & Profiles ===== -->
    <section class="section active" id="section-overview">
      <div class="section-header">
        <h1 class="section-title">Overview & Profiles</h1>
        <p class="section-desc">High-level control and configuration profiles. Pick a preset and go, or dive into the details.</p>
      </div>

      <div class="summary-grid">
        <div class="summary-card" data-nav="geometry">
          <div class="summary-card-icon">&#x1F4D0;</div>
          <div class="summary-card-label">Geometry</div>
          <div class="summary-card-value" id="summaryGeometry">-- x --mm</div>
          <div class="summary-card-meta" id="summaryGeometryMeta">6 legs, 3 segments each</div>
        </div>
        <div class="summary-card" data-nav="servos">
          <div class="summary-card-icon">&#x2699;</div>
          <div class="summary-card-label">Servos</div>
          <div class="summary-card-value" id="summaryServos">18 servos</div>
          <div class="summary-card-meta" id="summaryServosMeta">Loading...</div>
        </div>
        <div class="summary-card" data-nav="gaits">
          <div class="summary-card-icon">&#x1F6B6;</div>
          <div class="summary-card-label">Active Gait</div>
          <div class="summary-card-value" id="summaryGait">--</div>
          <div class="summary-card-meta" id="summaryGaitMeta">Step: --mm, Height: --mm</div>
        </div>
        <div class="summary-card" data-nav="posture">
          <div class="summary-card-icon">&#x1F9CD;</div>
          <div class="summary-card-label">Body Pose</div>
          <div class="summary-card-value" id="summaryPose">Height: --mm</div>
          <div class="summary-card-meta" id="summaryPoseMeta">R: 0° P: 0° Y: 0°</div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="card-title">Profile Library</span>
          <span class="card-badge" id="profileCount">0 profiles</span>
          <div class="card-actions">
            <button class="btn btn-secondary btn-sm" id="btnImportProfile">Import</button>
            <button class="btn btn-primary btn-sm" id="btnNewProfile">+ New Profile</button>
          </div>
        </div>
        <table class="data-table" id="profileTable">
          <thead>
            <tr>
              <th style="width: 30px;"></th>
              <th>Name</th>
              <th>Last Modified</th>
              <th>Description</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="profileTableBody">
            <!-- Dynamically populated -->
          </tbody>
        </table>
        <div id="noProfilesMsg" style="display: none; padding: 24px; text-align: center; color: var(--text-muted);">
          No profiles found. Create a new profile to get started.
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="card-title">Quick Actions</span>
        </div>
        <div class="profile-actions" style="display: flex; gap: 12px; flex-wrap: wrap;">
          <button class="btn btn-primary btn-icon" id="btnCalibrationWizard">
            &#x1F527; Run Calibration Wizard
          </button>
          <button class="btn btn-success btn-icon" id="btnTestWalk">
            &#x1F6B6; Test Walk
          </button>
          <button class="btn btn-secondary btn-icon" id="btnSaveProfile">
            &#x1F4BE; Save Profile
          </button>
          <button class="btn btn-secondary btn-icon" id="btnDuplicateProfile">
            &#x1F4CB; Duplicate Profile
          </button>
          <button class="btn btn-secondary btn-icon" id="btnExportJson">
            &#x1F4E4; Export Config (JSON)
          </button>
          <button class="btn btn-secondary btn-icon" id="btnImportConfig">
            &#x1F4E5; Import Config
          </button>
          <button class="btn btn-danger btn-icon" id="btnDeleteProfile">
            &#x1F5D1; Delete Profile
          </button>
        </div>
      </div>
    </section>

    <!-- ===== SECTION: Geometry & Frames ===== -->
    <section class="section" id="section-geometry">
      <div class="section-header">
        <h1 class="section-title">Geometry & Frames</h1>
        <p class="section-desc">Define all the static math that IK depends on: body dimensions, leg kinematics, and coordinate frames.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="geo-body">Body Geometry</button>
        <button class="tab" data-tab="geo-legs">Leg Kinematics</button>
        <button class="tab" data-tab="geo-frames">Reference Frames</button>
      </div>

      <!-- Body Geometry Tab -->
      <div class="tab-content active" id="tab-geo-body">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Body Dimensions</span>
            <button class="btn btn-secondary btn-sm">Reset to Defaults</button>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Body Radius (Octagonal)</span>
                <span class="slider-value" id="bodyRadiusValue">80 mm</span>
              </div>
              <input type="range" class="slider" id="bodyRadius" data-config="body_radius" min="40" max="150" value="80">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Body Thickness</span>
                <span class="slider-value" id="bodyHeightGeoValue">30 mm</span>
              </div>
              <input type="range" class="slider" id="bodyHeightGeo" data-config="body_height_geo" min="15" max="80" value="30">
            </div>
          </div>
          <div class="form-group" style="margin-top: 16px;">
            <label class="form-label">Body Origin</label>
            <select class="form-select" style="max-width: 300px;">
              <option value="center">Center</option>
              <option value="front-center">Front Center</option>
              <option value="rear-center">Rear Center</option>
            </select>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Leg Attach Points</span>
            <div class="card-actions">
              <label style="display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--text-muted);">
                <input type="checkbox" checked id="symmetryMode"> Symmetry Mode
              </label>
            </div>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Leg</th>
                <th>X (mm)</th>
                <th>Y (mm)</th>
                <th>Z (mm)</th>
                <th>Angle (&deg;)</th>
              </tr>
            </thead>
            <tbody id="legAttachTable">
              <tr><td>Leg 0 (FR)</td><td><input type="number" class="form-input" value="150" style="width:80px"></td><td><input type="number" class="form-input" value="120" style="width:80px"></td><td><input type="number" class="form-input" value="0" style="width:80px"></td><td><input type="number" class="form-input" value="45" style="width:80px"></td></tr>
              <tr><td>Leg 1 (MR)</td><td><input type="number" class="form-input" value="0" style="width:80px"></td><td><input type="number" class="form-input" value="150" style="width:80px"></td><td><input type="number" class="form-input" value="0" style="width:80px"></td><td><input type="number" class="form-input" value="90" style="width:80px"></td></tr>
              <tr><td>Leg 2 (RR)</td><td><input type="number" class="form-input" value="-150" style="width:80px"></td><td><input type="number" class="form-input" value="120" style="width:80px"></td><td><input type="number" class="form-input" value="0" style="width:80px"></td><td><input type="number" class="form-input" value="135" style="width:80px"></td></tr>
              <tr><td>Leg 3 (RL)</td><td><input type="number" class="form-input" value="-150" style="width:80px"></td><td><input type="number" class="form-input" value="-120" style="width:80px"></td><td><input type="number" class="form-input" value="0" style="width:80px"></td><td><input type="number" class="form-input" value="225" style="width:80px"></td></tr>
              <tr><td>Leg 4 (ML)</td><td><input type="number" class="form-input" value="0" style="width:80px"></td><td><input type="number" class="form-input" value="-150" style="width:80px"></td><td><input type="number" class="form-input" value="0" style="width:80px"></td><td><input type="number" class="form-input" value="270" style="width:80px"></td></tr>
              <tr><td>Leg 5 (FL)</td><td><input type="number" class="form-input" value="150" style="width:80px"></td><td><input type="number" class="form-input" value="-120" style="width:80px"></td><td><input type="number" class="form-input" value="0" style="width:80px"></td><td><input type="number" class="form-input" value="315" style="width:80px"></td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Leg Kinematics Tab -->
      <div class="tab-content" id="tab-geo-legs">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Segment Lengths</span>
            <div class="card-actions">
              <label style="display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--text-muted);">
                <input type="checkbox" checked id="allLegsIdentical"> All Legs Identical
              </label>
            </div>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Coxa Length</span>
                <span class="slider-value" id="coxaLengthValue">40 mm</span>
              </div>
              <input type="range" class="slider" id="coxaLength" data-config="leg_coxa_length" min="20" max="80" value="40">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Femur Length</span>
                <span class="slider-value" id="femurLengthValue">80 mm</span>
              </div>
              <input type="range" class="slider" id="femurLength" data-config="leg_femur_length" min="40" max="150" value="80">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Tibia Length</span>
                <span class="slider-value" id="tibiaLengthValue">100 mm</span>
              </div>
              <input type="range" class="slider" id="tibiaLength" data-config="leg_tibia_length" min="40" max="150" value="100">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Axis Orientation</span>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Coxa Axis</label>
              <select class="form-select">
                <option value="z">Yaw around Z (vertical)</option>
                <option value="y">Yaw around Y</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Femur Axis</label>
              <select class="form-select">
                <option value="y">Pitch around Y</option>
                <option value="x">Pitch around X</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Tibia Axis</label>
              <select class="form-select">
                <option value="y">Pitch around Y</option>
                <option value="x">Pitch around X</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Reference Frames Tab -->
      <div class="tab-content" id="tab-geo-frames">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Coordinate Frames</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Frame</th>
                <th>Parent</th>
                <th>Position (x, y, z)</th>
                <th>Orientation (R, P, Y)</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>world</strong></td>
                <td>-</td>
                <td>0, 0, 0</td>
                <td>0&deg;, 0&deg;, 0&deg;</td>
                <td><span class="tag tag-primary">Fixed</span></td>
              </tr>
              <tr>
                <td><strong>body</strong></td>
                <td>world</td>
                <td>0, 0, 120</td>
                <td>0&deg;, 0&deg;, 0&deg;</td>
                <td><button class="btn btn-secondary btn-sm">Edit</button></td>
              </tr>
              <tr>
                <td><strong>camera_front</strong></td>
                <td>body</td>
                <td>100, 0, 50</td>
                <td>0&deg;, -10&deg;, 0&deg;</td>
                <td><button class="btn btn-secondary btn-sm">Edit</button></td>
              </tr>
              <tr>
                <td><strong>camera_rear</strong></td>
                <td>body</td>
                <td>-100, 0, 50</td>
                <td>0&deg;, -10&deg;, 180&deg;</td>
                <td><button class="btn btn-secondary btn-sm">Edit</button></td>
              </tr>
              <tr>
                <td><strong>imu</strong></td>
                <td>body</td>
                <td>0, 0, 10</td>
                <td>0&deg;, 0&deg;, 0&deg;</td>
                <td><button class="btn btn-secondary btn-sm">Edit</button></td>
              </tr>
            </tbody>
          </table>
          <div style="margin-top: 16px;">
            <button class="btn btn-secondary btn-sm">+ Add Frame</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== SECTION: Servos & Calibration ===== -->
    <section class="section" id="section-servos">
      <div class="section-header">
        <h1 class="section-title">Servos & Calibration</h1>
        <p class="section-desc">Hardware-level servo configuration: channel mapping, limits, offsets, and calibration wizard.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="servo-mapping">Servo Mapping</button>
        <button class="tab" data-tab="servo-limits">Limits & Tuning</button>
        <button class="tab" data-tab="servo-wizard">Calibration Wizard</button>
      </div>

      <!-- Servo Mapping Tab -->
      <div class="tab-content active" id="tab-servo-mapping">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Channel Assignment</span>
            <div class="card-actions">
              <button class="btn btn-secondary btn-sm" id="btnRefreshCalibration">Refresh Status</button>
              <button class="btn btn-primary btn-sm" id="btnSaveCalibration">Save Calibration</button>
              <button class="btn btn-secondary btn-sm" id="btnAutoFillTemplate">Auto-fill Template</button>
              <button class="btn btn-warning btn-sm">Highlight All</button>
            </div>
          </div>

          <div class="status-grid" id="calibrationStatusGrid">
            <div class="status-item">
              <div class="status-item-label">Calibration File</div>
              <div class="status-item-value" id="calibrationPath">--</div>
              <div style="margin-top: 6px; display: flex; gap: 6px; align-items: center;">
                <span class="tag tag-warning" id="calibrationExistsTag">Unknown</span>
                <span class="status-item-label" id="calibrationSize">--</span>
              </div>
            </div>
            <div class="status-item">
              <div class="status-item-label">Hardware Backend</div>
              <div class="status-item-value" id="calibrationHardware">--</div>
              <div class="status-item-label" id="calibrationUpdated">Last checked: --</div>
            </div>
            <div class="status-item">
              <div class="status-item-label">Mapped Channels</div>
              <div class="status-item-value" id="calibrationMapped">0 / 18</div>
              <div class="status-item-label" id="calibrationLegs">Legs configured: 0</div>
            </div>
            <div class="status-item">
              <div class="status-item-label">Available Channels</div>
              <div class="status-item-value" id="calibrationAvailable">--</div>
              <div class="status-item-label" id="calibrationUnmappedCount">Unmapped joints: 18</div>
            </div>
          </div>

          <div class="status-item" style="margin-top: 12px;">
            <div class="status-item-label">Unmapped joints</div>
            <div id="calibrationUnmappedList" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 6px; color: var(--text-muted);">
              <span style="font-size: 12px;">--</span>
            </div>
          </div>

          <table class="data-table">
            <thead>
              <tr>
                <th>Logical Name</th>
                <th>Bus/Channel</th>
                <th>Leg</th>
                <th>Joint</th>
                <th>Direction</th>
                <th>Neutral (&micro;s)</th>
                <th>Test</th>
              </tr>
            </thead>
            <tbody id="servoMappingTable">
              <!-- Generated by JS -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Servo Limits Tab -->
      <div class="tab-content" id="tab-servo-limits">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Joint Limits & Tuning</span>
            <div class="card-actions">
              <button class="btn btn-secondary btn-sm">Apply to All</button>
            </div>
          </div>

          <div class="hexapod-diagram" style="margin-bottom: 20px;">
            <div style="text-align: center; font-size: 11px; color: var(--text-muted); margin-bottom: 8px;">Click a leg to configure its limits</div>
            <svg class="hexapod-svg" viewBox="0 0 200 140" id="servoLegDiagram">
              <ellipse cx="100" cy="70" rx="35" ry="25" fill="#333" stroke="#555" stroke-width="2"/>
              <text x="100" y="74" text-anchor="middle" fill="#666" font-size="8" font-weight="bold">BODY</text>
              <polygon points="100,35 95,45 105,45" fill="var(--accent)" opacity="0.6"/>
              <g class="leg-btn" data-leg="0"><line x1="130" y1="50" x2="165" y2="25" stroke="#aa6633" stroke-width="4" stroke-linecap="round"/><circle cx="165" cy="25" r="8" fill="#44dd88" stroke="#333" stroke-width="2"/><text x="175" y="28" fill="#888" font-size="8">0</text></g>
              <g class="leg-btn" data-leg="1"><line x1="135" y1="70" x2="180" y2="70" stroke="#aa6633" stroke-width="4" stroke-linecap="round"/><circle cx="180" cy="70" r="8" fill="#44dd88" stroke="#333" stroke-width="2"/><text x="188" y="73" fill="#888" font-size="8">1</text></g>
              <g class="leg-btn" data-leg="2"><line x1="130" y1="90" x2="165" y2="115" stroke="#aa6633" stroke-width="4" stroke-linecap="round"/><circle cx="165" cy="115" r="8" fill="#44dd88" stroke="#333" stroke-width="2"/><text x="175" y="118" fill="#888" font-size="8">2</text></g>
              <g class="leg-btn" data-leg="3"><line x1="70" y1="90" x2="35" y2="115" stroke="#aa6633" stroke-width="4" stroke-linecap="round"/><circle cx="35" cy="115" r="8" fill="#44dd88" stroke="#333" stroke-width="2"/><text x="20" y="118" fill="#888" font-size="8">3</text></g>
              <g class="leg-btn" data-leg="4"><line x1="65" y1="70" x2="20" y2="70" stroke="#aa6633" stroke-width="4" stroke-linecap="round"/><circle cx="20" cy="70" r="8" fill="#44dd88" stroke="#333" stroke-width="2"/><text x="5" y="73" fill="#888" font-size="8">4</text></g>
              <g class="leg-btn" data-leg="5"><line x1="70" y1="50" x2="35" y2="25" stroke="#aa6633" stroke-width="4" stroke-linecap="round"/><circle cx="35" cy="25" r="8" fill="#44dd88" stroke="#333" stroke-width="2"/><text x="20" y="28" fill="#888" font-size="8">5</text></g>
            </svg>
          </div>

          <div id="servoLimitsPanel" style="display: none;">
            <h4 style="color: var(--accent); margin-bottom: 16px;" id="servoLimitsTitle">Leg 0 - Front Right</h4>
            <div class="form-row">
              <div>
                <h5 style="color: var(--text-muted); font-size: 12px; margin-bottom: 12px;">COXA</h5>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Hard Min</span><span class="slider-value">-60&deg;</span></div>
                  <input type="range" class="slider" min="-90" max="0" value="-60">
                </div>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Hard Max</span><span class="slider-value">60&deg;</span></div>
                  <input type="range" class="slider" min="0" max="90" value="60">
                </div>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Neutral</span><span class="slider-value">0&deg;</span></div>
                  <input type="range" class="slider" min="-30" max="30" value="0">
                </div>
              </div>
              <div>
                <h5 style="color: var(--text-muted); font-size: 12px; margin-bottom: 12px;">FEMUR</h5>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Hard Min</span><span class="slider-value">-30&deg;</span></div>
                  <input type="range" class="slider" min="-90" max="0" value="-30">
                </div>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Hard Max</span><span class="slider-value">90&deg;</span></div>
                  <input type="range" class="slider" min="0" max="120" value="90">
                </div>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Neutral</span><span class="slider-value">45&deg;</span></div>
                  <input type="range" class="slider" min="0" max="90" value="45">
                </div>
              </div>
              <div>
                <h5 style="color: var(--text-muted); font-size: 12px; margin-bottom: 12px;">TIBIA</h5>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Hard Min</span><span class="slider-value">-120&deg;</span></div>
                  <input type="range" class="slider" min="-150" max="0" value="-120">
                </div>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Hard Max</span><span class="slider-value">0&deg;</span></div>
                  <input type="range" class="slider" min="-30" max="30" value="0">
                </div>
                <div class="slider-group">
                  <div class="slider-header"><span class="slider-label">Neutral</span><span class="slider-value">-90&deg;</span></div>
                  <input type="range" class="slider" min="-120" max="0" value="-90">
                </div>
              </div>
            </div>
            <div style="margin-top: 16px; display: flex; gap: 8px;">
              <button class="btn btn-primary btn-sm" id="btnTestSweep">Test Sweep</button>
              <button class="btn btn-secondary btn-sm" id="btnResetLimits">Reset to Defaults</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Calibration Wizard Tab -->
      <div class="tab-content" id="tab-servo-wizard">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Calibration Wizard</span>
          </div>
          <div style="padding: 20px; text-align: center;">
            <div style="font-size: 48px; margin-bottom: 16px;">&#x1F527;</div>
            <h3 style="margin-bottom: 8px;">Step-by-Step Calibration</h3>
            <p style="color: var(--text-muted); margin-bottom: 24px;">
              This wizard will guide you through calibrating each servo for optimal performance.
            </p>
            <div style="background: var(--control-bg); padding: 16px; border-radius: 8px; text-align: left; max-width: 500px; margin: 0 auto;">
              <ol style="color: var(--text-muted); font-size: 13px; line-height: 2; padding-left: 20px;">
                <li>Place hexapod on a calibration stand</li>
                <li>Move all joints to calibration pose (neutral angles)</li>
                <li>For each leg, align to visually "straight" position</li>
                <li>Press "Set as neutral" to compute and save offset</li>
              </ol>
            </div>
            <button class="btn btn-primary" style="margin-top: 24px;">Start Calibration Wizard</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== SECTION: Body Posture & Poses ===== -->
    <section class="section" id="section-posture">
      <div class="section-header">
        <h1 class="section-title">Body Posture & Poses</h1>
        <p class="section-desc">Define static poses and default posture parameters for standing, resting, and special positions.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="posture-default">Default Stance</button>
        <button class="tab" data-tab="posture-poses">Custom Poses</button>
      </div>

      <!-- Default Stance Tab -->
      <div class="tab-content active" id="tab-posture-default">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Standing Parameters</span>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Body Height</span>
                <span class="slider-value" id="stanceHeightValue">120 mm</span>
              </div>
              <input type="range" class="slider" id="stanceHeight" data-config="body_height" min="50" max="200" value="120">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Leg Spread</span>
                <span class="slider-value" id="legSpreadValue">100%</span>
              </div>
              <input type="range" class="slider" id="legSpread" data-config="leg_spread" min="50" max="150" value="100">
            </div>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Roll</span>
                <span class="slider-value" id="stanceRollValue">0&deg;</span>
              </div>
              <input type="range" class="slider" id="stanceRoll" data-config="body_roll" min="-30" max="30" value="0">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Pitch</span>
                <span class="slider-value" id="stancePitchValue">0&deg;</span>
              </div>
              <input type="range" class="slider" id="stancePitch" data-config="body_pitch" min="-30" max="30" value="0">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Yaw</span>
                <span class="slider-value" id="stanceYawValue">0&deg;</span>
              </div>
              <input type="range" class="slider" id="stanceYaw" data-config="body_yaw" min="-45" max="45" value="0">
            </div>
          </div>
          <div class="toggle-group">
            <div>
              <div class="toggle-label">Keep body level (IMU)</div>
              <div class="toggle-desc">Automatically compensate for terrain tilt using IMU data</div>
            </div>
            <label class="toggle">
              <input type="checkbox" id="keepBodyLevel" data-config="keep_body_level">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>

      <!-- Custom Poses Tab -->
      <div class="tab-content" id="tab-posture-poses">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Saved Poses</span>
            <span class="card-badge" id="poseCount">0 poses</span>
            <button class="btn btn-primary btn-sm" id="btnNewPose">+ New Pose</button>
          </div>
          <table class="data-table" id="savedPosesTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Height</th>
                <th>Leg Spread</th>
                <th>Orientation</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="posesTableBody">
              <!-- Poses will be populated dynamically by JavaScript -->
            </tbody>
          </table>
          <p id="noPosesMsg" style="color: var(--text-muted); text-align: center; padding: 24px; display: none;">
            No poses saved yet. Create your first pose below.
          </p>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Record Current Pose</span>
          </div>
          <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 16px;">
            Capture the robot's current posture and save as a new pose.
          </p>
          <div class="form-row" style="align-items: flex-end;">
            <div class="form-group" style="flex: 1;">
              <label class="form-label">Pose Name</label>
              <input type="text" class="form-input" id="recordPoseName" placeholder="Enter pose name...">
            </div>
            <div class="form-group">
              <label class="form-label">Category</label>
              <select class="form-select" id="recordPoseCategory">
                <option value="operation">Operation</option>
                <option value="rest">Rest</option>
                <option value="debug">Debug</option>
              </select>
            </div>
            <button class="btn btn-success" id="btnRecordPose">Record Pose</button>
          </div>
        </div>

        <!-- Create/Edit Pose Modal -->
        <div class="card" id="poseEditorCard" style="display: none; border: 2px solid var(--primary);">
          <div class="card-header">
            <span class="card-title" id="poseEditorTitle">Create New Pose</span>
            <button class="btn btn-secondary btn-sm" id="btnCancelPoseEdit">Cancel</button>
          </div>
          <div class="form-row">
            <div class="form-group" style="flex: 1;">
              <label class="form-label">Pose Name</label>
              <input type="text" class="form-input" id="editPoseName" placeholder="Enter pose name...">
            </div>
            <div class="form-group">
              <label class="form-label">Category</label>
              <select class="form-select" id="editPoseCategory">
                <option value="operation">Operation</option>
                <option value="rest">Rest</option>
                <option value="debug">Debug</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Height</span>
                <span class="slider-value" id="editPoseHeightValue">120 mm</span>
              </div>
              <input type="range" class="slider" id="editPoseHeight" min="30" max="200" value="120">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Leg Spread</span>
                <span class="slider-value" id="editPoseLegSpreadValue">100%</span>
              </div>
              <input type="range" class="slider" id="editPoseLegSpread" min="50" max="150" value="100">
            </div>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Roll</span>
                <span class="slider-value" id="editPoseRollValue">0&deg;</span>
              </div>
              <input type="range" class="slider" id="editPoseRoll" min="-30" max="30" value="0">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Pitch</span>
                <span class="slider-value" id="editPosePitchValue">0&deg;</span>
              </div>
              <input type="range" class="slider" id="editPosePitch" min="-30" max="30" value="0">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Yaw</span>
                <span class="slider-value" id="editPoseYawValue">0&deg;</span>
              </div>
              <input type="range" class="slider" id="editPoseYaw" min="-45" max="45" value="0">
            </div>
          </div>
          <div style="display: flex; gap: 12px; margin-top: 16px;">
            <button class="btn btn-secondary" id="btnPreviewPoseEdit">Preview</button>
            <button class="btn btn-primary" id="btnSavePose">Save Pose</button>
          </div>
          <input type="hidden" id="editPoseId" value="">
        </div>
      </div>
    </section>

    <!-- ===== SECTION: Gaits & Motion ===== -->
    <section class="section" id="section-gaits">
      <div class="section-header">
        <h1 class="section-title">Gaits & Motion</h1>
        <p class="section-desc">Configure walking gaits, motion parameters, and movement smoothing.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="gait-templates">Gait Templates</button>
        <button class="tab" data-tab="gait-params">Gait Parameters</button>
        <button class="tab" data-tab="gait-smoothing">Motion Smoothing</button>
      </div>

      <!-- Gait Templates Tab -->
      <div class="tab-content active" id="tab-gait-templates">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Available Gaits</span>
            <span class="card-badge" id="gaitCount">0 gaits</span>
          </div>
          <table class="data-table" id="gaitsTable">
            <thead>
              <tr>
                <th style="width: 40px;"></th>
                <th>Gait</th>
                <th>Speed Range</th>
                <th>Stability</th>
                <th>Best For</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="gaitsTableBody">
              <!-- Populated dynamically from API -->
            </tbody>
          </table>
          <div id="noGaitsMsg" style="display: none; padding: 24px; text-align: center; color: var(--text-muted);">
            No gaits configured. Check your configuration.
          </div>
        </div>
      </div>

      <!-- Gait Parameters Tab -->
      <div class="tab-content" id="tab-gait-params">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Tripod Gait Parameters</span>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Stride Length</span>
                <span class="slider-value">100 mm</span>
              </div>
              <input type="range" class="slider" data-config="step_length" min="30" max="150" value="100">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Step Height</span>
                <span class="slider-value">30 mm</span>
              </div>
              <input type="range" class="slider" data-config="step_height" min="10" max="80" value="30">
            </div>
              <div class="slider-group">
                <div class="slider-header">
                  <span class="slider-label">Duty Factor</span>
                  <span class="slider-value" id="gaitDutyFactorValue">65%</span>
                </div>
                <input type="range" class="slider" id="gaitDutyFactor" data-config="gait_duty_factor" min="40" max="80" value="65">
              </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Cycle Time</span>
                <span class="slider-value">1.0 s</span>
              </div>
              <input type="range" class="slider" data-config="cycle_time" min="0.5" max="2.5" step="0.1" value="1.0">
            </div>
          </div>

          <div class="card-header" style="margin-top: 24px;">
            <span class="card-title">Phase Offsets</span>
          </div>
          <div class="phase-timeline">
            <div class="phase-node stance">L0<br><small>0&deg;</small></div>
            <div class="phase-connector"></div>
            <div class="phase-node swing">L1<br><small>120&deg;</small></div>
            <div class="phase-connector"></div>
            <div class="phase-node stance">L2<br><small>240&deg;</small></div>
            <div class="phase-connector"></div>
            <div class="phase-node stance">L3<br><small>0&deg;</small></div>
            <div class="phase-connector"></div>
            <div class="phase-node swing">L4<br><small>120&deg;</small></div>
            <div class="phase-connector"></div>
            <div class="phase-node stance">L5<br><small>240&deg;</small></div>
          </div>
          <p style="text-align: center; color: var(--text-muted); font-size: 11px; margin-top: 8px;">
            <span style="color: var(--success);">&#9632;</span> Stance (ground contact) &nbsp;&nbsp;
            <span style="color: var(--danger);">&#9632;</span> Swing (in air)
          </p>

          <div class="card-header" style="margin-top: 24px;">
            <span class="card-title">Turn Behavior</span>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Turn Mode</label>
              <select class="form-select" id="turnMode" data-config="turn_mode">
                <option value="in-place">In-place rotation</option>
                <option value="arc">Arc turn</option>
                <option value="differential">Differential</option>
              </select>
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Yaw Rate</span>
                <span class="slider-value" id="maxYawRateValue">60 &deg;/s</span>
              </div>
              <input type="range" class="slider" id="maxYawRate" data-config="max_yaw_rate" min="20" max="120" value="60">
            </div>
          </div>
        </div>
      </div>

      <!-- Motion Smoothing Tab -->
      <div class="tab-content" id="tab-gait-smoothing">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Acceleration Limits</span>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Linear Acceleration</span>
                <span class="slider-value" id="maxLinearAccelValue">0.5 m/s&sup2;</span>
              </div>
              <input type="range" class="slider" id="maxLinearAccel" data-config="max_linear_accel" min="0.1" max="2" step="0.1" value="0.5">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Angular Acceleration</span>
                <span class="slider-value" id="maxAngularAccelValue">90 &deg;/s&sup2;</span>
              </div>
              <input type="range" class="slider" id="maxAngularAccel" data-config="max_angular_accel" min="30" max="180" value="90">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Command Smoothing</span>
          </div>
          <div class="toggle-group">
            <div>
              <div class="toggle-label">Smooth Joystick Input</div>
              <div class="toggle-desc">Apply exponential smoothing to control inputs</div>
            </div>
            <label class="toggle">
              <input type="checkbox" id="inputSmoothingEnabled" data-config="input_smoothing_enabled" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="slider-group" style="margin-top: 16px;">
            <div class="slider-header">
              <span class="slider-label">Smoothing Factor</span>
              <span class="slider-value" id="inputSmoothingFactorValue">0.15</span>
            </div>
            <input type="range" class="slider" id="inputSmoothingFactor" data-config="input_smoothing_factor" min="0.05" max="0.5" step="0.01" value="0.15">
          </div>
        </div>
      </div>
    </section>

    <!-- ===== SECTION: Sensors & Cameras ===== -->
    <section class="section" id="section-sensors">
      <div class="section-header">
        <h1 class="section-title">Sensors & Cameras</h1>
        <p class="section-desc">Configure cameras, IMU, foot contact sensors, and other sensing hardware.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="sensor-cameras">Cameras</button>
        <button class="tab" data-tab="sensor-imu">IMU</button>
        <button class="tab" data-tab="sensor-other">Other Sensors</button>
      </div>

      <!-- Cameras Tab -->
      <div class="tab-content active" id="tab-sensor-cameras">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Camera Configuration</span>
            <button class="btn btn-primary btn-sm">+ Add Camera</button>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Interface</th>
                <th>Role</th>
                <th>Resolution</th>
                <th>FPS</th>
                <th>Stream</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>front_cam</strong></td>
                <td>/dev/video0</td>
                <td><span class="tag tag-success">Main Navigation</span></td>
                <td>1280x720</td>
                <td>30</td>
                <td>/api/stream/front</td>
                <td>
                  <button class="btn btn-secondary btn-sm">Edit</button>
                  <button class="btn btn-secondary btn-sm">Preview</button>
                </td>
              </tr>
              <tr>
                <td><strong>rear_cam</strong></td>
                <td>/dev/video1</td>
                <td><span class="tag tag-primary">Rear View</span></td>
                <td>640x480</td>
                <td>15</td>
                <td>/api/stream/rear</td>
                <td>
                  <button class="btn btn-secondary btn-sm">Edit</button>
                  <button class="btn btn-secondary btn-sm">Preview</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Camera Transform: front_cam</span>
          </div>
          <div class="transform-editor">
            <div class="transform-axis">
              <div class="transform-axis-label">Position X</div>
              <input type="number" class="transform-axis-input" value="100">
            </div>
            <div class="transform-axis">
              <div class="transform-axis-label">Position Y</div>
              <input type="number" class="transform-axis-input" value="0">
            </div>
            <div class="transform-axis">
              <div class="transform-axis-label">Position Z</div>
              <input type="number" class="transform-axis-input" value="50">
            </div>
            <div class="transform-axis">
              <div class="transform-axis-label">Roll</div>
              <input type="number" class="transform-axis-input" value="0">
            </div>
            <div class="transform-axis">
              <div class="transform-axis-label">Pitch</div>
              <input type="number" class="transform-axis-input" value="-10">
            </div>
            <div class="transform-axis">
              <div class="transform-axis-label">Yaw</div>
              <input type="number" class="transform-axis-input" value="0">
            </div>
          </div>
        </div>
      </div>

      <!-- IMU Tab -->
      <div class="tab-content" id="tab-sensor-imu">
        <div class="card">
          <div class="card-header">
            <span class="card-title">IMU Configuration</span>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">IMU Device</label>
              <select class="form-select config-select" id="imu-device" data-config-key="imu_device">
                <option value="MPU6050">MPU6050 (I2C)</option>
                <option value="BNO055">BNO055 (I2C)</option>
                <option value="ICM20948">ICM20948 (SPI)</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Filter Type</label>
              <select class="form-select config-select" id="imu-filter" data-config-key="imu_filter_type">
                <option value="complementary">Complementary Filter</option>
                <option value="ekf">Extended Kalman Filter</option>
                <option value="madgwick">Madgwick Filter</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Sample Rate (Hz)</label>
              <input type="number" class="form-input config-input" id="imu-sample-rate" data-config-key="imu_sample_rate" min="10" max="500" value="100" style="width: 100px;">
            </div>
          </div>
          <div class="card-header" style="margin-top: 16px;">
            <span class="card-title">Mounting Orientation</span>
          </div>
          <div class="transform-editor">
            <div class="transform-axis">
              <div class="transform-axis-label">Roll Offset</div>
              <input type="number" class="transform-axis-input config-input" id="imu-roll-offset" data-config-key="imu_roll_offset" value="0" step="0.1">
            </div>
            <div class="transform-axis">
              <div class="transform-axis-label">Pitch Offset</div>
              <input type="number" class="transform-axis-input config-input" id="imu-pitch-offset" data-config-key="imu_pitch_offset" value="0" step="0.1">
            </div>
            <div class="transform-axis">
              <div class="transform-axis-label">Yaw Offset</div>
              <input type="number" class="transform-axis-input config-input" id="imu-yaw-offset" data-config-key="imu_yaw_offset" value="0" step="0.1">
            </div>
          </div>
        </div>
      </div>

      <!-- Other Sensors Tab -->
      <div class="tab-content" id="tab-sensor-other">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Foot Contact Sensors</span>
          </div>
          <div class="toggle-group" style="margin-bottom: 16px;">
            <div>
              <div class="toggle-label">Enable Foot Contact Sensing</div>
              <div class="toggle-desc">Detect ground contact using servo current monitoring</div>
            </div>
            <label class="toggle">
              <input type="checkbox" class="config-toggle" id="foot-sensor-enabled" data-config-key="foot_sensor_enabled" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Sensor Type</label>
              <select class="form-select config-select" id="foot-sensor-type" data-config-key="foot_sensor_type">
                <option value="current">Current Spike Detection</option>
                <option value="force">Force Sensor (FSR)</option>
                <option value="switch">Mechanical Switch</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Detection Threshold</label>
              <input type="number" class="form-input config-input" id="foot-sensor-threshold" data-config-key="foot_sensor_threshold" value="150" min="50" max="500" style="width: 100px;">
              <span class="form-hint" style="margin-left: 8px;">mA (for current type)</span>
            </div>
          </div>
          <div class="card-header" style="margin-top: 16px;">
            <span class="card-title">Leg Status</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Leg</th>
                <th>Contact Status</th>
                <th>Current (mA)</th>
              </tr>
            </thead>
            <tbody id="foot-sensor-status">
              <tr><td>Leg 0 (FR)</td><td><span class="tag tag-success" id="foot-0-status">Contact</span></td><td id="foot-0-current">142</td></tr>
              <tr><td>Leg 1 (MR)</td><td><span class="tag tag-success" id="foot-1-status">Contact</span></td><td id="foot-1-current">138</td></tr>
              <tr><td>Leg 2 (RR)</td><td><span class="tag tag-success" id="foot-2-status">Contact</span></td><td id="foot-2-current">145</td></tr>
              <tr><td>Leg 3 (RL)</td><td><span class="tag tag-success" id="foot-3-status">Contact</span></td><td id="foot-3-current">140</td></tr>
              <tr><td>Leg 4 (ML)</td><td><span class="tag tag-success" id="foot-4-status">Contact</span></td><td id="foot-4-current">137</td></tr>
              <tr><td>Leg 5 (FL)</td><td><span class="tag tag-success" id="foot-5-status">Contact</span></td><td id="foot-5-current">144</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ===== SECTION: Control & Input ===== -->
    <section class="section" id="section-control">
      <div class="section-header">
        <h1 class="section-title">Control & Input Mapping</h1>
        <p class="section-desc">Map external inputs (gamepad, keyboard, API) to robot motion commands.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="control-modes">Control Modes</button>
        <button class="tab" data-tab="control-gamepad">Gamepad</button>
        <button class="tab" data-tab="control-keyboard">Keyboard & API</button>
      </div>

      <!-- Control Modes Tab -->
      <div class="tab-content active" id="tab-control-modes">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Available Modes</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th></th>
                <th>Mode</th>
                <th>Description</th>
                <th>Priority</th>
              </tr>
            </thead>
            <tbody id="control-mode-table">
              <tr>
                <td><input type="radio" name="controlMode" value="gamepad" id="control-mode-gamepad"></td>
                <td><strong>Manual Joystick</strong></td>
                <td>Direct control via gamepad or virtual joystick</td>
                <td><span class="tag tag-danger">High</span></td>
              </tr>
              <tr>
                <td><input type="radio" name="controlMode" value="keyboard" id="control-mode-keyboard" checked></td>
                <td><strong>Keyboard</strong></td>
                <td>WASD + arrow key control</td>
                <td><span class="tag tag-danger">High</span></td>
              </tr>
              <tr>
                <td><input type="radio" name="controlMode" value="autonomous" id="control-mode-autonomous"></td>
                <td><strong>Autonomous Navigation</strong></td>
                <td>AI-driven movement with obstacle avoidance</td>
                <td><span class="tag tag-warning">Medium</span></td>
              </tr>
              <tr>
                <td><input type="radio" name="controlMode" value="scripted" id="control-mode-scripted"></td>
                <td><strong>Scripted Motion</strong></td>
                <td>Pre-programmed movement sequences</td>
                <td><span class="tag tag-primary">Low</span></td>
              </tr>
            </tbody>
          </table>
          <div class="form-group" style="margin-top: 16px;">
            <label class="form-label">Default Mode at Startup</label>
            <select class="form-select config-select" id="control-default-mode" data-config-key="control_default_mode" style="max-width: 300px;">
              <option value="gamepad">Manual Joystick</option>
              <option value="keyboard">Keyboard</option>
              <option value="autonomous">Autonomous Navigation</option>
              <option value="scripted">Scripted Motion</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Gamepad Tab -->
      <div class="tab-content" id="tab-control-gamepad">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Gamepad Mapping</span>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Connected Controller</label>
              <select class="form-select" id="gamepad-controller">
                <option value="xbox">Xbox Controller</option>
                <option value="playstation">PlayStation Controller</option>
                <option value="generic">Generic Gamepad</option>
              </select>
              <span class="form-hint" id="gamepad-status" style="margin-left: 8px; color: var(--text-muted);">Not connected</span>
            </div>
          </div>

          <h4 style="color: var(--text-muted); font-size: 12px; margin: 16px 0 12px;">Stick Mapping</h4>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Left Stick X</label>
              <select class="form-select config-select" id="gamepad-left-x" data-config-key="gamepad_left_x_action">
                <option value="strafe">Strafe (left/right)</option>
                <option value="yaw">Yaw (rotate)</option>
                <option value="disabled">Disabled</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Left Stick Y</label>
              <select class="form-select config-select" id="gamepad-left-y" data-config-key="gamepad_left_y_action">
                <option value="forward">Forward/Back</option>
                <option value="pitch">Body Pitch</option>
                <option value="disabled">Disabled</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Right Stick X</label>
              <select class="form-select config-select" id="gamepad-right-x" data-config-key="gamepad_right_x_action">
                <option value="yaw">Yaw (rotate)</option>
                <option value="strafe">Strafe (left/right)</option>
                <option value="disabled">Disabled</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Right Stick Y</label>
              <select class="form-select config-select" id="gamepad-right-y" data-config-key="gamepad_right_y_action">
                <option value="height">Body Height</option>
                <option value="pitch">Body Pitch</option>
                <option value="disabled">Disabled</option>
              </select>
            </div>
          </div>

          <h4 style="color: var(--text-muted); font-size: 12px; margin: 16px 0 12px;">Button Mapping</h4>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">A Button</label>
              <select class="form-select config-select" id="gamepad-a" data-config-key="gamepad_a_action">
                <option value="toggle_gait">Toggle Gait</option>
                <option value="start_stop">Start/Stop</option>
                <option value="disabled">Disabled</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">B Button</label>
              <select class="form-select config-select" id="gamepad-b" data-config-key="gamepad_b_action">
                <option value="crouch">Crouch/Stand</option>
                <option value="estop">E-Stop</option>
                <option value="disabled">Disabled</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">X Button</label>
              <select class="form-select config-select" id="gamepad-x" data-config-key="gamepad_x_action">
                <option value="camera">Camera Switch</option>
                <option value="toggle_gait">Toggle Gait</option>
                <option value="disabled">Disabled</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Y Button</label>
              <select class="form-select config-select" id="gamepad-y" data-config-key="gamepad_y_action">
                <option value="pose">Predefined Pose</option>
                <option value="record">Record Pose</option>
                <option value="disabled">Disabled</option>
              </select>
            </div>
          </div>

          <h4 style="color: var(--text-muted); font-size: 12px; margin: 16px 0 12px;">Input Tuning</h4>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Deadzone</span>
                <span class="slider-value" id="gamepad-deadzone-value">10%</span>
              </div>
              <input type="range" class="slider config-slider" id="gamepad-deadzone" data-config-key="gamepad_deadzone" data-unit="%" min="0" max="30" value="10">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Exponential Curve</span>
                <span class="slider-value" id="gamepad-expo-value">1.5</span>
              </div>
              <input type="range" class="slider config-slider" id="gamepad-expo" data-config-key="gamepad_expo_curve" data-unit="" min="1" max="3" step="0.1" value="1.5">
            </div>
          </div>
        </div>
      </div>

      <!-- Keyboard & API Tab -->
      <div class="tab-content" id="tab-control-keyboard">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Keyboard Mapping</span>
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
            <div class="key-binding"><span class="key-action">Move Forward</span><div class="key-combo"><span class="key">W</span><span class="key">&uarr;</span></div></div>
            <div class="key-binding"><span class="key-action">Move Backward</span><div class="key-combo"><span class="key">S</span><span class="key">&darr;</span></div></div>
            <div class="key-binding"><span class="key-action">Strafe Left</span><div class="key-combo"><span class="key">A</span><span class="key">&larr;</span></div></div>
            <div class="key-binding"><span class="key-action">Strafe Right</span><div class="key-combo"><span class="key">D</span><span class="key">&rarr;</span></div></div>
            <div class="key-binding"><span class="key-action">Rotate Left</span><div class="key-combo"><span class="key">Q</span></div></div>
            <div class="key-binding"><span class="key-action">Rotate Right</span><div class="key-combo"><span class="key">E</span></div></div>
            <div class="key-binding"><span class="key-action">Start/Stop</span><div class="key-combo"><span class="key">Space</span></div></div>
            <div class="key-binding"><span class="key-action">Emergency Stop</span><div class="key-combo"><span class="key">Esc</span></div></div>
            <div class="key-binding"><span class="key-action">Gait: Tripod</span><div class="key-combo"><span class="key">1</span></div></div>
            <div class="key-binding"><span class="key-action">Gait: Wave</span><div class="key-combo"><span class="key">2</span></div></div>
            <div class="key-binding"><span class="key-action">Gait: Ripple</span><div class="key-combo"><span class="key">3</span></div></div>
            <div class="key-binding"><span class="key-action">Gait: Creep</span><div class="key-combo"><span class="key">4</span></div></div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">API Endpoints</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Endpoint</th>
                <th>Method</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr><td><code>/api/gait</code></td><td>POST</td><td>Set gait mode (tripod, wave, ripple)</td></tr>
              <tr><td><code>/api/gait/params</code></td><td>GET/POST</td><td>Get or set gait parameters (step_height, step_length, cycle_time)</td></tr>
              <tr><td><code>/api/run</code></td><td>POST</td><td>Start/stop walking ({"run": true/false})</td></tr>
              <tr><td><code>/api/stop</code></td><td>POST</td><td>Stop walking</td></tr>
              <tr><td><code>/api/body_height</code></td><td>POST</td><td>Set body height in mm (30-90)</td></tr>
              <tr><td><code>/api/body_pose</code></td><td>GET/POST</td><td>Get or set body pose (pitch, roll, yaw)</td></tr>
              <tr><td><code>/api/leg_spread</code></td><td>POST</td><td>Set leg spread percentage (50-150%)</td></tr>
              <tr><td><code>/api/rotation</code></td><td>POST</td><td>Set rotation speed (degrees/second)</td></tr>
              <tr><td><code>/api/emergency_stop</code></td><td>POST</td><td>Trigger emergency stop - halts all movement</td></tr>
              <tr><td><code>/api/status</code></td><td>GET</td><td>Get current robot status and telemetry</td></tr>
              <tr><td><code>/api/sensors</code></td><td>GET</td><td>Get sensor readings (temperature, battery)</td></tr>
              <tr><td><code>/api/health</code></td><td>GET</td><td>Health check endpoint</td></tr>
              <tr><td><code>/api/config</code></td><td>GET/POST</td><td>Get or update configuration values</td></tr>
              <tr><td><code>/api/config/save</code></td><td>POST</td><td>Save configuration to file</td></tr>
              <tr><td><code>/api/profiles</code></td><td>GET/POST</td><td>List profiles or manage (create, delete, switch)</td></tr>
              <tr><td><code>/api/servo/test</code></td><td>POST</td><td>Test a specific servo (leg, joint, angle)</td></tr>
              <tr><td><code>/ws</code></td><td>WebSocket</td><td>Real-time telemetry and command streaming</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ===== SECTION: Safety & Limits ===== -->
    <section class="section" id="section-safety">
      <div class="section-header">
        <h1 class="section-title">Safety & Limits</h1>
        <p class="section-desc">Configure safety limits, emergency stop behavior, and fault handling to protect your hardware.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="safety-limits">Joint & Speed Limits</button>
        <button class="tab" data-tab="safety-workspace">Workspace & Terrain</button>
        <button class="tab" data-tab="safety-estop">E-Stop & Faults</button>
      </div>

      <!-- Joint & Speed Limits Tab -->
      <div class="tab-content active" id="tab-safety-limits">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Global Motion Limits</span>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Body Translation Speed</span>
                <span class="slider-value" id="safety-translation-speed-value">0.3 m/s</span>
              </div>
              <input type="range" class="slider config-slider" id="safety-translation-speed" data-config-key="safety_max_translation_speed" data-unit=" m/s" min="0.1" max="1" step="0.05" value="0.3">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Rotation Speed</span>
                <span class="slider-value" id="safety-rotation-speed-value">60 &deg;/s</span>
              </div>
              <input type="range" class="slider config-slider" id="safety-rotation-speed" data-config-key="safety_max_rotation_speed" data-unit="&deg;/s" min="20" max="120" value="60">
            </div>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Joint Speed</span>
                <span class="slider-value" id="safety-joint-speed-value">300 &deg;/s</span>
              </div>
              <input type="range" class="slider config-slider" id="safety-joint-speed" data-config-key="safety_max_joint_speed" data-unit="&deg;/s" min="60" max="600" value="300">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Temperature Limit</span>
                <span class="slider-value" id="safety-temp-limit-value">70 &deg;C</span>
              </div>
              <input type="range" class="slider config-slider" id="safety-temp-limit" data-config-key="safety_temperature_limit" data-unit="&deg;C" min="40" max="85" value="70">
            </div>
          </div>
        </div>
      </div>

      <!-- Workspace & Terrain Tab -->
      <div class="tab-content" id="tab-safety-workspace">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Terrain Safety</span>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Body Tilt (Auto-Stop)</span>
                <span class="slider-value" id="safety-tilt-stop-value">30&deg;</span>
              </div>
              <input type="range" class="slider config-slider" id="safety-tilt-stop" data-config-key="safety_max_body_tilt_stop" data-unit="&deg;" min="10" max="45" value="30">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Body Tilt (Auto-Correct)</span>
                <span class="slider-value" id="safety-tilt-correct-value">15&deg;</span>
              </div>
              <input type="range" class="slider config-slider" id="safety-tilt-correct" data-config-key="safety_max_body_tilt_correct" data-unit="&deg;" min="5" max="25" value="15">
            </div>
          </div>
          <div class="form-row">
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Max Step Height</span>
                <span class="slider-value" id="safety-step-height-value">50 mm</span>
              </div>
              <input type="range" class="slider config-slider" id="safety-step-height" data-config-key="safety_max_step_height" data-unit=" mm" min="20" max="100" value="50">
            </div>
            <div class="slider-group">
              <div class="slider-header">
                <span class="slider-label">Min Ground Clearance</span>
                <span class="slider-value" id="safety-ground-clearance-value">30 mm</span>
              </div>
              <input type="range" class="slider config-slider" id="safety-ground-clearance" data-config-key="safety_min_ground_clearance" data-unit=" mm" min="10" max="80" value="30">
            </div>
          </div>
        </div>
      </div>

      <!-- E-Stop & Faults Tab -->
      <div class="tab-content" id="tab-safety-estop">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Emergency Stop Behavior</span>
          </div>
          <div class="form-group">
            <label class="form-label">E-Stop Action</label>
            <select class="form-select config-select" id="estop-action" data-config-key="estop_action" style="max-width: 400px;">
              <option value="disable_torque">Disable All Torque (servos go limp)</option>
              <option value="hold_pose">Hold Current Pose</option>
              <option value="safe_collapse">Gently Collapse to Rest Pose</option>
              <option value="cut_power">Cut Power Completely</option>
            </select>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Auto E-Stop Triggers</span>
          </div>
          <div class="toggle-group">
            <div>
              <div class="toggle-label">Loss of Communication</div>
              <div class="toggle-desc">Trigger E-Stop if connection lost for &gt;500ms</div>
            </div>
            <label class="toggle">
              <input type="checkbox" class="config-toggle" id="estop-comm-loss" data-config-key="estop_on_comm_loss" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-group">
            <div>
              <div class="toggle-label">Servo Error/Overheating</div>
              <div class="toggle-desc">Trigger E-Stop on servo fault or temperature &gt;limit</div>
            </div>
            <label class="toggle">
              <input type="checkbox" class="config-toggle" id="estop-servo-error" data-config-key="estop_on_servo_error" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-group">
            <div>
              <div class="toggle-label">IMU Roll/Pitch Exceeded</div>
              <div class="toggle-desc">Trigger E-Stop if body tilt exceeds max limit</div>
            </div>
            <label class="toggle">
              <input type="checkbox" class="config-toggle" id="estop-tilt" data-config-key="estop_on_tilt_exceeded" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-group">
            <div>
              <div class="toggle-label">Low Battery Voltage</div>
              <div class="toggle-desc" id="estop-battery-desc">Trigger E-Stop if voltage drops below threshold</div>
            </div>
            <label class="toggle">
              <input type="checkbox" class="config-toggle" id="estop-battery" data-config-key="estop_on_low_battery" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="slider-group" style="margin-top: 12px; margin-left: 24px;">
            <div class="slider-header">
              <span class="slider-label">Low Battery Threshold</span>
              <span class="slider-value" id="safety-battery-threshold-value">9.5 V</span>
            </div>
            <input type="range" class="slider config-slider" id="safety-battery-threshold" data-config-key="safety_low_battery_threshold" data-unit=" V" min="8.0" max="11.0" step="0.1" value="9.5">
          </div>
          <div class="slider-group" style="margin-top: 12px; margin-left: 24px;">
            <div class="slider-header">
              <span class="slider-label">Communication Loss Timeout</span>
              <span class="slider-value" id="estop-comm-timeout-value">500 ms</span>
            </div>
            <input type="range" class="slider config-slider" id="estop-comm-timeout" data-config-key="estop_comm_loss_timeout" data-unit=" ms" min="100" max="2000" step="50" value="500">
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Fault Recovery</span>
          </div>
          <div class="form-group">
            <label class="form-label">After Fault Clear</label>
            <select class="form-select config-select" id="fault-recovery" data-config-key="fault_recovery_action" style="max-width: 400px;">
              <option value="stay_stopped">Stay Stopped Until Manual Reset</option>
              <option value="return_safe">Attempt Return to Safe Pose</option>
              <option value="auto_resume">Auto Resume Previous State</option>
            </select>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== SECTION: System & Network ===== -->
    <section class="section" id="section-system">
      <div class="section-header">
        <h1 class="section-title">System & Networking</h1>
        <p class="section-desc">Configure network settings, system parameters, and view firmware information.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="sys-network">Network</button>
        <button class="tab" data-tab="sys-time">Time & Sync</button>
        <button class="tab" data-tab="sys-firmware">Firmware</button>
      </div>

      <!-- Network Tab -->
      <div class="tab-content active" id="tab-sys-network">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Network Configuration</span>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Hostname</label>
              <input type="text" class="form-input config-input" id="sys-hostname" data-config-key="system_hostname" value="hexapod-01">
            </div>
            <div class="form-group">
              <label class="form-label">IP Address</label>
              <input type="text" class="form-input" id="sys-ip-address" value="(detecting...)" disabled>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">IP Mode</label>
              <select class="form-select" id="sys-ip-mode" disabled>
                <option>DHCP</option>
                <option>Static</option>
              </select>
              <small style="color: var(--text-muted);">Network mode is read-only</small>
            </div>
            <div class="form-group">
              <label class="form-label">Web UI Port</label>
              <input type="number" class="form-input config-input" id="sys-web-port" data-config-key="system_web_port" value="8000">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Authentication</span>
          </div>
          <div class="toggle-group">
            <div>
              <div class="toggle-label">Require Authentication</div>
              <div class="toggle-desc">Password protect web interface and API</div>
            </div>
            <label class="toggle">
              <input type="checkbox" class="config-toggle" id="sys-require-auth" data-config-key="system_require_auth">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="form-row" style="margin-top: 16px;">
            <div class="form-group">
              <label class="form-label">API Token</label>
              <input type="password" class="form-input" id="sys-api-token" value="" placeholder="(not set)" style="font-family: monospace;">
            </div>
            <div style="display: flex; align-items: flex-end; gap: 8px;">
              <button class="btn btn-secondary btn-sm" id="sys-show-token">Show</button>
              <button class="btn btn-secondary btn-sm" id="sys-regenerate-token">Regenerate</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Time & Sync Tab -->
      <div class="tab-content" id="tab-sys-time">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Time Configuration</span>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Timezone</label>
              <select class="form-select config-select" id="sys-timezone" data-config-key="system_timezone">
                <option value="UTC">UTC</option>
                <option value="America/Los_Angeles">America/Los_Angeles</option>
                <option value="America/New_York">America/New_York</option>
                <option value="Europe/London">Europe/London</option>
                <option value="Europe/Berlin">Europe/Berlin</option>
                <option value="Asia/Tokyo">Asia/Tokyo</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Current Time</label>
              <input type="text" class="form-input" id="sys-current-time" value="(loading...)" disabled>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">NTP Servers</label>
            <input type="text" class="form-input config-input" id="sys-ntp-servers" data-config-key="system_ntp_servers" value="pool.ntp.org, time.google.com">
          </div>
        </div>
      </div>

      <!-- Firmware Tab -->
      <div class="tab-content" id="tab-sys-firmware">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Version Information</span>
          </div>
          <table class="data-table" id="sys-version-table">
            <tbody>
              <tr><td><strong>Software Version</strong></td><td id="sys-version">1.0.0</td></tr>
              <tr><td><strong>Config Schema</strong></td><td id="sys-schema">v1</td></tr>
              <tr><td><strong>Hardware Mode</strong></td><td id="sys-hw-mode">Mock</td></tr>
              <tr><td><strong>Python Runtime</strong></td><td id="sys-python">3.x</td></tr>
              <tr><td><strong>Uptime</strong></td><td id="sys-uptime">-</td></tr>
            </tbody>
          </table>
        </div>
        <div class="card">
          <div class="card-header">
            <span class="card-title">System Actions</span>
          </div>
          <div style="display: flex; gap: 12px; flex-wrap: wrap;">
            <button class="btn btn-secondary" id="sys-export-config">Export Configuration</button>
            <button class="btn btn-secondary" id="sys-import-config">Import Configuration</button>
            <button class="btn btn-danger" id="sys-reset-defaults">Reset to Defaults</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== SECTION: Logging & Diagnostics ===== -->
    <section class="section" id="section-logging">
      <div class="section-header">
        <h1 class="section-title">Logging & Diagnostics</h1>
        <p class="section-desc">Configure logging levels, view live telemetry, and run self-test routines.</p>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="log-levels">Logging Levels</button>
        <button class="tab" data-tab="log-telemetry">Live Telemetry</button>
        <button class="tab" data-tab="log-selftest">Self-Test</button>
      </div>

      <!-- Logging Levels Tab -->
      <div class="tab-content active" id="tab-log-levels">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Per-Channel Log Levels</span>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Channel</th>
                <th>Level</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Kinematics & IK</td>
                <td><select class="form-select config-select" id="log-level-kinematics" data-config-key="log_level_kinematics" style="width: 100px;"><option value="ERROR">ERROR</option><option value="WARN">WARN</option><option value="INFO">INFO</option><option value="DEBUG">DEBUG</option></select></td>
                <td>Inverse kinematics calculations and leg positioning</td>
              </tr>
              <tr>
                <td>Servo Commands</td>
                <td><select class="form-select config-select" id="log-level-servo" data-config-key="log_level_servo" style="width: 100px;"><option value="ERROR">ERROR</option><option value="WARN">WARN</option><option value="INFO">INFO</option><option value="DEBUG">DEBUG</option></select></td>
                <td>Servo angle commands and feedback</td>
              </tr>
              <tr>
                <td>Sensors (IMU, Cameras)</td>
                <td><select class="form-select config-select" id="log-level-sensors" data-config-key="log_level_sensors" style="width: 100px;"><option value="ERROR">ERROR</option><option value="WARN">WARN</option><option value="INFO">INFO</option><option value="DEBUG">DEBUG</option></select></td>
                <td>Sensor readings and processing</td>
              </tr>
              <tr>
                <td>Gait Planner</td>
                <td><select class="form-select config-select" id="log-level-gait" data-config-key="log_level_gait" style="width: 100px;"><option value="ERROR">ERROR</option><option value="WARN">WARN</option><option value="INFO">INFO</option><option value="DEBUG">DEBUG</option></select></td>
                <td>Gait state machine and foot placement</td>
              </tr>
              <tr>
                <td>Network/API</td>
                <td><select class="form-select config-select" id="log-level-network" data-config-key="log_level_network" style="width: 100px;"><option value="ERROR">ERROR</option><option value="WARN">WARN</option><option value="INFO">INFO</option><option value="DEBUG">DEBUG</option></select></td>
                <td>WebSocket, REST API, and network events</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Live Telemetry Tab -->
      <div class="tab-content" id="tab-log-telemetry">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Real-Time Status</span>
            <div class="card-actions">
              <button class="btn btn-success btn-sm" id="recordBtn">Record Session</button>
              <button class="btn btn-secondary btn-sm">Download Logs</button>
            </div>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
            <div>
              <h4 style="color: var(--text-muted); font-size: 11px; margin-bottom: 12px;">JOINT ANGLES</h4>
              <div class="sparkline-container"><span class="sparkline-label">L0 Coxa</span><div class="sparkline" id="spark-l0-coxa"></div><span class="sparkline-value">12.5&deg;</span></div>
              <div class="sparkline-container"><span class="sparkline-label">L0 Femur</span><div class="sparkline" id="spark-l0-femur"></div><span class="sparkline-value">45.2&deg;</span></div>
              <div class="sparkline-container"><span class="sparkline-label">L0 Tibia</span><div class="sparkline" id="spark-l0-tibia"></div><span class="sparkline-value">-92.1&deg;</span></div>
            </div>
            <div>
              <h4 style="color: var(--text-muted); font-size: 11px; margin-bottom: 12px;">BODY POSE</h4>
              <div class="sparkline-container"><span class="sparkline-label">Roll</span><div class="sparkline" id="spark-roll"></div><span class="sparkline-value">0.3&deg;</span></div>
              <div class="sparkline-container"><span class="sparkline-label">Pitch</span><div class="sparkline" id="spark-pitch"></div><span class="sparkline-value">-1.2&deg;</span></div>
              <div class="sparkline-container"><span class="sparkline-label">Yaw</span><div class="sparkline" id="spark-yaw"></div><span class="sparkline-value">45.0&deg;</span></div>
            </div>
          </div>

          <h4 style="color: var(--text-muted); font-size: 11px; margin-bottom: 12px;">FOOT CONTACT</h4>
          <div style="display: flex; gap: 16px; justify-content: center; margin-bottom: 16px;">
            <div style="text-align: center;"><div data-foot="0" style="width: 30px; height: 30px; border-radius: 50%; background: var(--success); margin: 0 auto;"></div><div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">L0</div></div>
            <div style="text-align: center;"><div data-foot="1" style="width: 30px; height: 30px; border-radius: 50%; background: var(--danger); margin: 0 auto;"></div><div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">L1</div></div>
            <div style="text-align: center;"><div data-foot="2" style="width: 30px; height: 30px; border-radius: 50%; background: var(--success); margin: 0 auto;"></div><div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">L2</div></div>
            <div style="text-align: center;"><div data-foot="3" style="width: 30px; height: 30px; border-radius: 50%; background: var(--success); margin: 0 auto;"></div><div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">L3</div></div>
            <div style="text-align: center;"><div data-foot="4" style="width: 30px; height: 30px; border-radius: 50%; background: var(--danger); margin: 0 auto;"></div><div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">L4</div></div>
            <div style="text-align: center;"><div data-foot="5" style="width: 30px; height: 30px; border-radius: 50%; background: var(--success); margin: 0 auto;"></div><div style="font-size: 10px; color: var(--text-muted); margin-top: 4px;">L5</div></div>
          </div>
          <p style="text-align: center; color: var(--text-muted); font-size: 10px;">
            <span style="color: var(--success);">&#9632;</span> Ground Contact &nbsp;&nbsp;
            <span style="color: var(--danger);">&#9632;</span> In Air
          </p>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Event Log</span>
          </div>
          <div class="log-panel" id="eventLog">
            <div class="log-entry"><span class="log-time">10:30:45</span><span class="log-level info">INFO</span><span class="log-message">Gait changed to tripod</span></div>
            <div class="log-entry"><span class="log-time">10:30:42</span><span class="log-level debug">DEBUG</span><span class="log-message">Telemetry rate set to 50Hz</span></div>
            <div class="log-entry"><span class="log-time">10:30:40</span><span class="log-level info">INFO</span><span class="log-message">WebSocket client connected</span></div>
            <div class="log-entry"><span class="log-time">10:30:35</span><span class="log-level warn">WARN</span><span class="log-message">Battery voltage: 11.4V (low)</span></div>
            <div class="log-entry"><span class="log-time">10:30:30</span><span class="log-level info">INFO</span><span class="log-message">System initialized successfully</span></div>
          </div>
        </div>
      </div>

      <!-- Self-Test Tab -->
      <div class="tab-content" id="tab-log-selftest">
        <div class="card">
          <div class="card-header">
            <span class="card-title">Self-Test Routines</span>
          </div>
          <p style="color: var(--text-muted); margin-bottom: 16px;">
            Run diagnostic tests to verify hardware functionality. Place robot on a stand before running leg tests.
          </p>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
            <button class="btn btn-secondary btn-icon">&#x1F9BF; Test Single Leg</button>
            <button class="btn btn-secondary btn-icon">&#x1F6B6; Walk Forward 2 Steps</button>
            <button class="btn btn-secondary btn-icon">&#x2696; Check Symmetry</button>
            <button class="btn btn-secondary btn-icon">&#x1F4F7; Camera Test</button>
            <button class="btn btn-secondary btn-icon">&#x1F9ED; IMU Calibration</button>
            <button class="btn btn-secondary btn-icon">&#x1F50B; Battery Check</button>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <span class="card-title">Test Results</span>
          </div>
          <div class="log-panel">
            <div class="log-entry"><span class="log-time">10:28:15</span><span class="log-level info">INFO</span><span class="log-message">Battery check: 11.4V (83%)</span></div>
            <div class="log-entry"><span class="log-time">10:28:10</span><span class="log-level info">INFO</span><span class="log-message">IMU calibration complete - offset applied</span></div>
            <div class="log-entry"><span class="log-time">10:28:05</span><span class="log-level info">INFO</span><span class="log-message">Camera test: front_cam OK, rear_cam OK</span></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- ===== RIGHT PANEL ===== -->
  <aside class="right-panel">
    <div class="preview-container">
      <canvas class="preview-canvas" id="previewCanvas"></canvas>
      <div class="preview-controls">
        <button class="preview-btn active" data-view="iso">Iso</button>
        <button class="preview-btn" data-view="front">Front</button>
        <button class="preview-btn" data-view="side">Side</button>
        <button class="preview-btn" data-view="top">Top</button>
      </div>
    </div>
    <div class="status-panel">
      <div class="status-title">Live Status</div>
      <div class="status-grid">
        <div class="status-item">
          <div class="status-item-label">Body Height</div>
          <div class="status-item-value" id="liveHeight">120 mm</div>
        </div>
        <div class="status-item">
          <div class="status-item-label">Speed</div>
          <div class="status-item-value" id="liveSpeed">0.0 m/s</div>
        </div>
        <div class="status-item">
          <div class="status-item-label">Roll</div>
          <div class="status-item-value" id="liveRoll">0.3&deg;</div>
        </div>
        <div class="status-item">
          <div class="status-item-label">Pitch</div>
          <div class="status-item-value" id="livePitch">-1.2&deg;</div>
        </div>
        <div class="status-item">
          <div class="status-item-label">Temperature</div>
          <div class="status-item-value" id="liveTemp">42&deg;C</div>
        </div>
        <div class="status-item">
          <div class="status-item-label">Battery</div>
          <div class="status-item-value" id="liveBattery">11.4V</div>
        </div>
      </div>
      <div class="test-actions">
        <button class="test-btn" id="testStand">Stand</button>
        <button class="test-btn" id="testCrouch">Crouch</button>
        <button class="test-btn" id="testWalk">Walk Test</button>
        <button class="test-btn" id="testReset">Reset Pose</button>
      </div>
    </div>
  </aside>

  <!-- ===== SCRIPTS ===== -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.149.0/build/three.min.js"></script>
  <script src="/static/hexapod-3d.js"></script>
  <script src="/static/config.js"></script>
</body>
</html>
